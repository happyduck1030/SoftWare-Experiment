# 前端 API 对接测试流程

## 测试前准备

1. 确保后端服务已启动

   ```bash
   cd backend
   npm start
   ```

2. 确保前端服务已启动

   ```bash
   cd frontend
   npm run dev
   ```

3. 确保数据库中有测试数据
   - 可以运行 `npm run seed` 添加测试数据
   - 或手动通过后端 API 添加一些基础数据

## 测试流程

### 1. 管理员登录测试

- 访问 `http://localhost:5173/auth/login`
- 使用管理员账号登录
- 验证登录成功后跳转到管理员主页

### 2. 档案管理功能测试

#### 2.1 档案登记页面 (ArchiveRegister)

- 访问路径：`/admin/archive-register`
- 测试点：
  - 页面加载时显示加载状态    数据库里的员工都是在职状态，为何显示都是待复核
  - 机构下拉框能正确显示机构列表  无法显示所属机构
  - 选择机构后，职位下拉框能正确显示对应职位 不通过
  - 填写表单并提交，验证是否成功创建档案  无法提交
  - 新创建的档案显示在列表中   
  - 验证必填字段验证           通过

#### 2.2 档案变更页面 (ArchiveUpdate)

- 访问路径：`/admin/archive-update`
- 测试点：
  - 页面加载时显示已复核的档案列表
  - 点击"变更"按钮打开编辑模态框
  - 修改档案信息并提交
  - 验证更新成功提示

#### 2.3 档案复核页面 (ArchiveReview)

- 访问路径：`/admin/archive-review`
- 测试点：
  - 页面加载时显示待复核的档案列表
  - 点击"复核"按钮查看档案详情
  - 点击"通过"按钮，验证档案从列表中移除
  - 点击"驳回"按钮，验证需要填写驳回原因

#### 2.4 档案查询页面 (ArchiveSearch)

- 访问路径：`/admin/archive-search`
- 测试点：
  - 页面加载时显示已复核的档案列表
  - 使用搜索功能按姓名、电话、机构、职位筛选
  - 点击"查看详情"按钮查看档案完整信息

### 3. 组织架构管理测试

#### 3.1 机构设置页面 (OrganizationSettings)

- 访问路径：`/admin/organization-settings`
- 测试点：
  - 页面加载时显示机构树结构
  - 点击"添加一级机构"创建新机构
  - 点击"添加下级"为现有机构添加子机构
  - 点击"编辑"修改机构信息
  - 点击"删除"删除机构（需确认无下级机构和职位）

#### 3.2 职位设置页面 (PositionSettings)

- 访问路径：`/admin/position-settings`
- 测试点：
  - 页面加载时显示职位列表
  - 点击"添加职位"创建新职位
  - 选择机构和填写职位名称
  - 编辑现有职位信息
  - 删除职位（需确认无员工）

### 4. 薪酬管理测试

#### 4.1 薪酬项目设置页面 (SalaryItemSettings)

- 访问路径：`/admin/salary-item-settings`
- 测试点：
  - 页面加载时显示薪酬项目列表
  - 点击"添加薪酬项目"创建新项目
  - 选择项目类型（固定/浮动）
  - 编辑现有项目信息
  - 删除项目

#### 4.2 薪酬标准登记页面 (SalaryStandardRegister)

- 访问路径：`/admin/salary-standard-register`
- 测试点：
  - 页面加载时显示薪酬标准列表
  - 点击"登记薪酬标准"创建新标准
  - 选择机构和职位
  - 设置各薪酬项目金额
  - 验证总额自动计算

#### 4.3 薪酬标准变更页面 (SalaryStandardUpdate)

- 访问路径：`/admin/salary-standard-update`
- 测试点：
  - 页面加载时显示现有薪酬标准
  - 点击"变更"修改标准
  - 修改各项目金额
  - 提交后验证更新成功

### 5. 员工端功能测试

#### 5.1 组织信息页面 (OrganizationInfo)

- 访问路径：`/employee/organization-info`
- 测试点：
  - 页面加载时显示完整的组织架构树
  - 显示各级机构统计数量
  - 支持展开/折叠子机构

#### 5.2 员工档案页面 (EmployeeArchive)

- 访问路径：`/employee/archive`
- 测试点：
  - 页面加载时显示个人档案信息
  - 显示基本信息、职位信息、上级信息等
  - 数据格式正确显示

#### 5.3 员工薪酬页面 (EmployeeSalary)

- 访问路径：`/employee/salary`
- 测试点：
  - 页面加载时显示薪酬记录列表
  - 显示统计信息（记录数、总收入、平均收入）
  - 点击"查看明细"查看薪酬详情

## 常见问题排查

### 1. API 请求失败

- 检查后端服务是否正常运行
- 检查 API URL 配置是否正确（查看 `src/services/api.js` 中的 BASE_URL）
- 检查浏览器控制台是否有 CORS 错误

### 2. 数据格式不匹配

- 检查前后端字段名称是否一致
- 查看网络请求和响应的数据格式
- 确认数据转换逻辑是否正确

### 3. 权限问题

- 确认用户已登录且 token 有效
- 检查请求头中是否包含正确的 Authorization
- 验证用户角色是否有相应权限

## 测试结果记录

请记录以下测试结果：

- [ ] 登录功能：通过/失败
- [ ] 档案管理：通过/失败
  - [ ] 档案登记：通过/失败
  - [ ] 档案变更：通过/失败
  - [ ] 档案复核：通过/失败
  - [ ] 档案查询：通过/失败
- [ ] 组织管理：通过/失败
  - [ ] 机构设置：通过/失败
  - [ ] 职位设置：通过/失败
- [ ] 薪酬管理：通过/失败
  - [ ] 薪酬项目：通过/失败
  - [ ] 薪酬标准：通过/失败
- [ ] 员工端：通过/失败
  - [ ] 组织信息：通过/失败
  - [ ] 员工档案：通过/失败
  - [ ] 员工薪酬：通过/失败

## 备注

- 所有修改都保留了原始假数据作为注释，方便对比参考
- 添加了适当的加载状态和错误处理
- 实现了数据格式转换，确保前后端数据一致性
- 添加了防重复提交机制
